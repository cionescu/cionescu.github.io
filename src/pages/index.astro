---
import Layout from '~/layouts/PageLayout.astro';

import Image from '~/components/common/Image.astro';
import HomeFooter from '~/components/home/HomeFooter.astro';
import { Icon } from 'astro-icon/components';
import { fetchPosts } from '~/utils/blog';
import { getPermalink } from '~/utils/permalinks';

const metadata = {
  title: 'Catalin Ionescu - Director, Application Engineering @ Mon Ami',
  ignoreTitleTemplate: true,
};

const illustrations = {
  rocket: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 220" fill="none" role="img" aria-label="Abstract capsule with small spark">
    <rect x="72" y="84" width="176" height="68" rx="34" fill="#EEF2FF"/>
    <rect x="72" y="84" width="176" height="68" rx="34" stroke="#0F172A" stroke-opacity="0.18" stroke-width="4"/>
    <circle cx="132" cy="118" r="6" fill="#0F172A" fill-opacity="0.35"/>
    <circle cx="160" cy="118" r="6" fill="#0F172A" fill-opacity="0.35"/>
    <circle cx="188" cy="118" r="6" fill="#0F172A" fill-opacity="0.35"/>
    <path d="M245 56l6 12 12 6-12 6-6 12-6-12-12-6 12-6 6-12z" fill="#0F172A" fill-opacity="0.22"/>
  </svg>`,
  meeting: `<svg viewBox="0 0 200 160" class="w-full h-40" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="100" cy="80" r="60" fill="#FEF3C7" fill-opacity="0.5" />
    <rect x="60" y="100" width="80" height="40" rx="2" fill="#D1D5DB" />
    <rect x="70" y="100" width="60" height="5" fill="#9CA3AF" />
    <circle cx="50" cy="90" r="15" fill="#4B5563" />
    <path d="M30 140C30 120 70 120 70 140" stroke="#4B5563" stroke-width="20" />
    <circle cx="150" cy="90" r="15" fill="#4B5563" />
    <path d="M130 140C130 120 170 120 170 140" stroke="#4B5563" stroke-width="20" />
    <rect x="80" y="40" width="40" height="30" fill="white" stroke="#9CA3AF" stroke-width="2" />
    <path d="M85 65L95 55L105 60L115 50" stroke="#EF4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
  </svg>`,
  cafe: `<svg viewBox="0 0 200 160" class="w-full h-40" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="100" cy="80" r="60" fill="#FFEDD5" fill-opacity="0.5" />
    <rect x="70" y="90" width="60" height="40" rx="4" fill="#374151" />
    <path d="M60 130H140L135 135H65L60 130Z" fill="#1F2937" />
    <path d="M145 100H155C157.761 100 160 102.239 160 105C160 107.761 157.761 110 155 110H145V100Z" stroke="#92400E" stroke-width="2" />
    <path d="M135 100V115C135 120.523 130.523 125 125 125H145C139.477 125 135 120.523 135 115V100Z" fill="#FCD34D" />
    <path d="M140 85Q145 80 140 75" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" />
    <path d="M135 90Q140 85 135 80" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" />
  </svg>`,
  consult: `<svg viewBox="0 0 120 120" class="w-full h-full" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="60" cy="60" r="50" fill="#F3F4F6" />
    <path d="M40 60H80M80 60L70 50M80 60L70 70" stroke="#2563EB" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" />
    <circle cx="40" cy="60" r="8" fill="#2563EB" />
    <circle cx="80" cy="60" r="8" fill="#F97316" />
  </svg>`,
  cto: `<svg viewBox="0 0 120 120" class="w-full h-full" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="60" cy="60" r="50" fill="#F3F4F6" />
    <rect x="40" y="40" width="40" height="40" rx="4" stroke="#4B5563" stroke-width="3" fill="white" />
    <path d="M40 55H80" stroke="#4B5563" stroke-width="2" />
    <path d="M50 40V35C50 32.2386 52.2386 30 55 30H65C67.7614 30 70 32.2386 70 35V40" stroke="#4B5563" stroke-width="3" />
  </svg>`,
  product: `<svg viewBox="0 0 120 120" class="w-full h-full" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="60" cy="60" r="50" fill="#F3F4F6" />
    <path d="M40 80L60 40L80 80H40Z" stroke="#F97316" stroke-width="4" stroke-linejoin="round" fill="white" />
    <circle cx="60" cy="65" r="8" fill="#F97316" />
  </svg>`,
};

const posts = await fetchPosts();
const latestIssues = posts
  .slice()
  .sort((a, b) => Number(new Date(b.publishDate)) - Number(new Date(a.publishDate)))
  .slice(0, 10);
---

<Layout metadata={metadata}>
    <main class="flex-grow">
      <section class="pt-16 pb-20 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto">
        <div class="grid md:grid-cols-2 gap-12 items-center">
          <div class="order-2 md:order-1 space-y-8">
            <div class="space-y-4">
              <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 tracking-tight">Hi there, I'm Catalin üëã</h1>
              <div class="text-lg text-gray-600 leading-relaxed space-y-4">
                <p>
                  I'm a Director of Engineering, building and running production systems in Ruby on Rails for a little
                  over a decade. Most of my work has been building multi-tenant CRM systems that are complex and
                  permission-heavy.
                </p>
                <p>
                  When I'm not building software, I train for Spartan races. This year I ran a Sprint and a 12k trail
                  race, and I'm currently preparing for a Super next year. Training gives me structure, feedback, and a
                  very honest way to measure progress.
                </p>
                <p>
                  I also like to play with new technologies, especially when they have to fit into my work. This blog is
                  where I write about that: what I try, what works, and what doesn't.
                </p>
                <!--p class="text-sm italic text-gray-500">
                  As a side thing, I enjoy sharing my experiences and helping developers grow into CTOs / Tech Leads.
                </p-->
              </div>
            </div>

            <div class="flex items-center space-x-2">
              <span class="text-sm font-medium text-gray-500 mr-2">Follow me on</span>
              <a
                href="https://www.threads.com/@catalinionescu_"
                class="p-2 text-gray-500 hover:text-primary hover:bg-primary/10 rounded-full transition-all"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Threads"
              >
                <Icon name="tabler:brand-threads" class="w-5 h-5" />
              </a>
              <a
                href="https://www.linkedin.com/in/ciionescu/"
                class="p-2 text-gray-500 hover:text-primary hover:bg-primary/10 rounded-full transition-all"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="LinkedIn"
              >
                <Icon name="tabler:brand-linkedin" class="w-5 h-5" />
              </a>
              <a
                href="https://twitter.com/cionescu1"
                class="p-2 text-gray-500 hover:text-primary hover:bg-primary/10 rounded-full transition-all"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Twitter"
              >
                <Icon name="tabler:brand-twitter" class="w-5 h-5" />
              </a>
              <a
                href="https://github.com/cionescu"
                class="p-2 text-gray-500 hover:text-primary hover:bg-primary/10 rounded-full transition-all"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="GitHub"
              >
                <Icon name="tabler:brand-github" class="w-5 h-5" />
              </a>
            </div>
          </div>

          <div class="order-1 md:order-2 flex justify-center md:justify-end">
            <div class="relative w-64 h-64 md:w-80 md:h-80">
              <div class="absolute inset-0 bg-gray-200 rounded-3xl transform rotate-3"></div>
              <div class="absolute inset-0 bg-gray-900 rounded-3xl overflow-hidden transform -rotate-2 shadow-2xl">
                <Image
                  class="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500 nolazy"
                  widths={[400, 768, 1024, 2040]}
                  sizes="(max-width: 767px) 400px, (max-width: 1023px) 768px, (max-width: 2039px) 1024px, 2040px"
                  loading="eager"
                  width={1024}
                  height={1024}
                  src="~/assets/images/profile_square.png"
                  alt="Catalin Portrait"
                />
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="py-20 bg-white border-y border-gray-100">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="text-center mb-16 relative">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
              <span class="underline decoration-accent-orange decoration-4 underline-offset-4">What I'm working on</span
              >
            </h2>
            <p class="text-gray-600 max-w-2xl mx-auto">
              Ongoing series about engineering, spartan training, and learning.
            </p>
          </div>

          <div class="grid md:grid-cols-3 gap-8">
            <a
              href="/ai-agent/building-ai-agent-part-1"
              class="group relative rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-card cursor-pointer border border-transparent hover:border-gray-100 bg-guide-blue"
            >
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-2xl">‚ú®</span>
                </div>
                <div class="rounded-xl bg-white/60 p-4">
                  <div set:html={illustrations.rocket} />
                </div>
                <div class="space-y-2">
                  <h3 class="text-xl font-bold text-gray-900 group-hover:text-accent-orange transition-colors">
                    Building AI Agents
                  </h3>
                  <p class="text-sm text-gray-600 leading-relaxed">
                    Notes from adding AI agents to production systems: constraints, trade-offs, and what it actually
                    looks like in a real Rails app.
                  </p>
                </div>
              </div>
            </a>

            <div
              class="group relative rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-card cursor-pointer border border-transparent hover:border-gray-100 bg-guide-yellow"
            >
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-2xl">üí™üèª</span>
                  <span
                    class="px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider text-green-700 bg-green-100 rounded-full"
                    >Coming up</span
                  >
                </div>
                <div class="rounded-xl bg-white/60 p-4">
                  <div set:html={illustrations.meeting} />
                </div>
                <div class="space-y-2">
                  <h3 class="text-xl font-bold text-gray-900 group-hover:text-accent-orange transition-colors">
                    Training for Spartan Races
                  </h3>
                  <p class="text-sm text-gray-600 leading-relaxed">
                    How I train, what breaks, what adapts, and how endurance training fits around a full-time
                    engineering role.
                  </p>
                </div>
              </div>
            </div>

            <div
              class="group relative rounded-2xl p-6 transition-all duration-300 hover:-translate-y-1 hover:shadow-card cursor-pointer border border-transparent hover:border-gray-100 bg-guide-peach"
            >
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-2xl">üíª</span>
                  <span
                    class="px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider text-green-700 bg-green-100 rounded-full"
                    >Coming up</span
                  >
                </div>
                <div class="rounded-xl bg-white/60 p-4">
                  <div set:html={illustrations.cafe} />
                </div>
                <div class="space-y-2">
                  <h3 class="text-xl font-bold text-gray-900 group-hover:text-accent-orange transition-colors">
                    Engineering Leadership
                  </h3>
                  <p class="text-sm text-gray-600 leading-relaxed">
                    Lessons from leading teams, making decisions under uncertainty, and seeing engineers grow over time.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <HomeFooter />
  </Layout>

  <style is:global>
    .hand-drawn-arrow {
      stroke-dasharray: 100;
      stroke-dashoffset: 100;
      animation: dash 2s ease-out forwards;
    }

    @keyframes dash {
      to {
        stroke-dashoffset: 0;
      }
    }
  </style>
